<!doctype html>
<html lang="ja">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="path_to_root" content="..">
  <script type="text/javascript" src="../theme.js"></script>
  <script type="text/javascript" src="../script.js" defer></script>
  <script type="text/javascript" src="../metadata.js" defer></script>
  <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-9MVM0NZK9L" defer></script><script type="text/javascript" src="../gtag.js" defer></script>
  <link rel="stylesheet" href="../style.css" />
  
  <title>VBA 簡易リファレンス</title>
</head>

  <body>
    <header class="site-header">
  <div class="header-inner">
    <h1 class="site-title"><a href="../index.html">Sinotcaの雑記帳</a></h1>
    <div class="header-actions">
      <button
        id="search-toggle"
        class="header-button"
        type="button"
        onclick="toggleSearchInput()"
        aria-label="Toggle search"
        aria-controls="searchbar"
        aria-expanded="false"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20" aria-hidden="true" focusable="false">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" />
        </svg>
      </button>
      <button
        id="theme-toggle"
        class="header-button"
        type="button"
        onclick="toggleTheme()"
        aria-label="Toggle color theme"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20" aria-hidden="true" focusable="false">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path d="M448 256c0-106-86-192-192-192v384c106 0 192-86 192-192zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z" />
        </svg>
      </button>
    </div>
  </div>
  <form id="searchbar" class="site-search hidden" role="search" onsubmit="return false;">
    <input
      type="search"
      id="search-input"
      onkeyup="searchAndRender()"
      placeholder="Search this site"
      aria-label="Search site"
    >
    <button
      type="button"
      class="header-button search-close"
      onclick="toggleSearchInput()"
      aria-label="Close search"
    >
      &times;
    </button>
  </form>
  <div id="search-result" class="hidden"></div>
</header>

    <main>
      <div id="date">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="1em" height="1em" style="fill: var(--header-fg);">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L64 64C28.7 64 0 92.7 0 128l0 16 0 48L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-256 0-48 0-16c0-35.3-28.7-64-64-64l-40 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L152 64l0-40zM48 192l352 0 0 256c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256z"/>
        </svg>
        2024-09-29 ~ 2024-09-29
      </div>
      <div> <a class="tag" href="../index.html?tag=ref">ref</a> <a class="tag" href="../index.html?tag=vba">vba</a> <a class="tag" href="../index.html?tag=lang">lang</a></div>
      <div id="toc"><ul><li><a href="#1">型</a><ul><li><a href="#1.1">値型と参照型</a></li><li><a href="#1.2">Variant 型</a></li><li><a href="#1.3">配列</a></li><li><a href="#1.4">ユーザー定義型</a></li></ul></li><li><a href="#2">変数宣言と代入</a></li><li><a href="#3">制御構文</a><ul><li><a href="#3.1">While ループ</a></li><li><a href="#3.2">Do While ループ</a></li><li><a href="#3.3">For ループ</a></li><li><a href="#3.4">For Each ループ</a></li></ul></li><li><a href="#4">標準機能</a><ul><li><a href="#4.1">辞書型</a></li></ul></li></ul></div>
      <div id="main-content">
        <h1 id="">VBA 簡易リファレンス</h1>
<h2 id="1">型</h2>
<h3 id="1.1">値型と参照型</h3>
<blockquote class="markdown-alert-note">
<p>公式に値型・参照型という用語はありません。</p>
</blockquote>
<p>値型</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">型</th><th style="text-align: left">説明</th><th style="text-align: left">例</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>Boolean</code></td><td style="text-align: left"><code>TRUE</code> or <code>FALSE</code></td><td style="text-align: left"><code>Dim a As Boolean: a = TRUE;</code></td></tr>
<tr><td style="text-align: left"><code>Byte</code></td><td style="text-align: left">8-bit 整数</td><td style="text-align: left"><code>Dim a As Byte: a = 10;</code></td></tr>
<tr><td style="text-align: left"><code>Integer</code></td><td style="text-align: left">16-bit 整数</td><td style="text-align: left"><code>Dim a As Integer: a = 10;</code></td></tr>
<tr><td style="text-align: left"><code>Long</code></td><td style="text-align: left">32-bit 整数</td><td style="text-align: left"><code>Dim a As Long: a = 10;</code></td></tr>
<tr><td style="text-align: left"><code>LongLong</code></td><td style="text-align: left">64-bit 整数</td><td style="text-align: left"><code>Dim a As LongLong: a = 10;</code></td></tr>
<tr><td style="text-align: left"><code>Single</code></td><td style="text-align: left">32-bit 浮動小数点数</td><td style="text-align: left"><code>Dim a As Single: a = 0.3;</code></td></tr>
<tr><td style="text-align: left"><code>Double</code></td><td style="text-align: left">64-bit 浮動小数点数</td><td style="text-align: left"><code>Dim a As Double: a = 0.3;</code></td></tr>
<tr><td style="text-align: left"><code>Decimal</code></td><td style="text-align: left">10進小数、宣言できない</td><td style="text-align: left"><code>Dim a As Variant: a = CDec(0.3);</code></td></tr>
<tr><td style="text-align: left"><code>Currency</code></td><td style="text-align: left">通貨</td><td style="text-align: left"><code>Dim a As Currency: a = 10;</code></td></tr>
<tr><td style="text-align: left"><code>Date</code></td><td style="text-align: left">100/01/01 から 9999/12/31</td><td style="text-align: left"><code>Dim a As Date: a = 10;</code></td></tr>
<tr><td style="text-align: left"><code>String</code></td><td style="text-align: left">文字列</td><td style="text-align: left"><code>Dim a As String: a = "Hello";</code></td></tr>
<tr><td style="text-align: left"><code>T(n)</code></td><td style="text-align: left">配列型</td><td style="text-align: left">-</td></tr>
<tr><td style="text-align: left">(UDT)</td><td style="text-align: left">ユーザ定義型</td><td style="text-align: left">-</td></tr>
</tbody></table>
</div>
<p>参照型</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">型</th><th style="text-align: left">説明</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>Collection</code></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"><code>Dictionary</code></td><td style="text-align: left"></td></tr>
<tr><td style="text-align: left"><code>Object</code></td><td style="text-align: left"></td></tr>
</tbody></table>
</div>
<h3 id="1.2">Variant 型</h3>
<p><code>Variant</code> は、任意の型を入れられる型です。
TypeScript の <code>any</code> のようなものです。</p>
<h3 id="1.3">配列</h3>
<p>1次元配列</p>
<pre><code class="language-vba">Dim a(100) As Long     ' Long で要素数 100
Dim b(7 To 10) As Long ' Long でインデックス 7 から 10
</code></pre>
<p>多次元配列</p>
<pre><code class="language-vba">Dim a(10, 20) As Long ' Rust でいう [[u32; 20]; 10]
</code></pre>
<p>動的配列</p>
<pre><code class="language-vba">Dim a() As Long
ReDim a(10)
</code></pre>
<h3 id="1.4">ユーザー定義型</h3>
<p>型宣言は次のようにします。</p>
<pre><code class="language-vba">Type UserType
    Name As String
    Age As Integer
End Type
</code></pre>
<p>宣言した型は次のように使います。</p>
<pre><code class="language-vba">Dim User As UserType
User.Name = "Smith"
User.Age = 20
</code></pre>
<h2 id="2">変数宣言と代入</h2>
<p>変数宣言には <code>Dim</code> キーワードを使う。</p>
<pre><code class="language-vba">Dim {変数名} As {型名}
</code></pre>
<p>値型の代入には <code>Let</code> キーワードを使います。
<code>Let</code> は省略可能です。</p>
<pre><code class="language-vba">Let {変数名} = {値}
</code></pre>
<p>参照型の代入には <code>Set</code> キーワードを使います。</p>
<pre><code class="language-vba">Set {変数名} = {値}
</code></pre>
<p><code>Set</code> はシャローコピーです。</p>
<pre><code class="language-vba">Dim a As Collection
Dim b As Collection

Set a = New Collection
a.Add "1"

Set b = a
b.Add = "2"

Debug.Print a.Count ' 2
</code></pre>
<blockquote class="markdown-alert-note">
<p><strong>なぜ <code>Set</code> と <code>Let</code> を使い分けるのか</strong></p>
<p><code>Let</code>/<code>Set</code> を書き分ける必要があるのは、それ無しでは何を代入すべきか分からないケースがあるからです。
VBA には、<a href="https://learn.microsoft.com/ja-jp/dotnet/visual-basic/programming-guide/language-features/procedures/how-to-declare-and-call-a-default-property">規定プロパティ</a>という機能がります。
メンバ参照時にプロパティ名を省略する機能です。
規定プロパティが値型の場合、次のコードのように <code>Let</code>/<code>Set</code> で代入の挙動が変わります。</p>
<pre><code class="language-vba">Dim v As Variant
Dim rng As Range
Set rng = ThisWorkbook.Sheets(1).Range("A1")
rng.Value = "test"

' 値型の代入。規定プロパティは String なのでそちらが使われる
Let v = rng
Debug.Print TypeName(v)  ' → String

' 参照型の代入。
Set v = rng
Debug.Print TypeName(v)  ' → Range
</code></pre>
</blockquote>
<h2 id="3">制御構文</h2>
<p>continue はないので <code>GoTo</code> を使います。</p>
<h3 id="3.1">While ループ</h3>
<pre><code class="language-vba">Do While {条件}
    Exit Do
LOOP
</code></pre>
<h3 id="3.2">Do While ループ</h3>
<pre><code class="language-vba">Do Until {条件}
    Exit Do
LOOP
</code></pre>
<h3 id="3.3">For ループ</h3>
<pre><code class="language-vba">For I = 1 To 10
    Exit For
Next I
</code></pre>
<h3 id="3.4">For Each ループ</h3>
<p>配列, <code>Collection</code> などの要素をループできます。</p>
<pre><code class="language-vba">For Each e In elems
    Exit For
Next e
</code></pre>
<h2 id="4">標準機能</h2>
<h3 id="4.1">辞書型</h3>
<pre><code class="language-vba">' 宣言・初期化
Dim d
Set d = CreateObject("Scripting.Dictionary")

' 追加
d.Add "a", "Athens"
d.Add "b", "Belgrade"
d.Add "c", "Cairo"
</code></pre>

      </div>
    </main>
    <footer>&copy; Sinotcaの雑記帳. All rights reserved.</footer>
  </body>
</html>
