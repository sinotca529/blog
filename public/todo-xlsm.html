<!doctype html>
<html lang="ja">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="path_to_root" content="..">
  <script type="text/javascript" src="../theme.js"></script>
  <script type="text/javascript" src="../script.js" defer></script>
  <script type="text/javascript" src="../metadata.js" defer></script>
  <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-9MVM0NZK9L" defer></script><script type="text/javascript" src="../gtag.js" defer></script>
  <link rel="stylesheet" href="../style.css" />
  
  <title>Excel で TODO リストを作る</title>
</head>

  <body>
    <header class="site-header">
  <div class="header-inner">
    <h1 class="site-title"><a href="../index.html">Sinotcaの雑記帳</a></h1>
    <div class="header-actions">
      <button
        id="search-toggle"
        class="header-button"
        type="button"
        onclick="toggleSearchInput()"
        aria-label="Toggle search"
        aria-controls="searchbar"
        aria-expanded="false"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20" aria-hidden="true" focusable="false">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" />
        </svg>
      </button>
      <button
        id="theme-toggle"
        class="header-button"
        type="button"
        onclick="toggleTheme()"
        aria-label="Toggle color theme"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20" aria-hidden="true" focusable="false">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path d="M448 256c0-106-86-192-192-192v384c106 0 192-86 192-192zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z" />
        </svg>
      </button>
    </div>
  </div>
  <form id="searchbar" class="site-search hidden" role="search" onsubmit="return false;">
    <input
      type="search"
      id="search-input"
      onkeyup="searchAndRender()"
      placeholder="Search this site"
      aria-label="Search site"
    >
    <button
      type="button"
      class="header-button search-close"
      onclick="toggleSearchInput()"
      aria-label="Close search"
    >
      &times;
    </button>
  </form>
  <div id="search-result" class="hidden"></div>
</header>

    <main>
      <div id="date">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="1em" height="1em" style="fill: var(--header-fg);">
          <!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
          <path d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L64 64C28.7 64 0 92.7 0 128l0 16 0 48L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-256 0-48 0-16c0-35.3-28.7-64-64-64l-40 0 0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40L152 64l0-40zM48 192l352 0 0 256c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256z"/>
        </svg>
        2025-08-03 ~ 2025-08-03
      </div>
      <div> <a class="tag" href="../index.html?tag=Excel">Excel</a> <a class="tag" href="../index.html?tag=Todo">Todo</a></div>
      <div id="toc"><ul><li><a href="#1">Step1. ブックを用意する</a></li><li><a href="#2">STEP1. シートを用意する</a></li><li><a href="#3">STEP2. テーブルを用意する</a></li><li><a href="#4">STEP3. タスクIDの自動採番</a></li></ul></div>
      <div id="main-content">
        <h1 id="">Excel で TODO リストを作る</h1>
<p>対象 :</p>
<ul>
<li>Excel でタスク管理をしたい人</li>
<li>何らかの事情で <strong>xlsm ファイルの DL が難しい人</strong></li>
</ul>
<p>やること</p>
<p>やらないこと</p>
<h2 id="1">Step1. ブックを用意する</h2>
<p>Excel で新規ブックを開き、 <code>todo.xlsm</code> という名前で保存します。</p>
<h2 id="2">STEP1. シートを用意する</h2>
<p>シートを2つ用意します。
シートのオブジェクト名は VBA エディタのプロパティウィンドウで設定できます。</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">シート名</th><th style="text-align: left">オブジェクト名</th><th style="text-align: left">役割</th></tr></thead><tbody>
<tr><td style="text-align: left">タスク</td><td style="text-align: left"><code>wsTasks</code></td><td style="text-align: left">タスクの一覧と実績の記入</td></tr>
<tr><td style="text-align: left">ログ</td><td style="text-align: left"><code>wsLogs</code></td><td style="text-align: left">実績の記録</td></tr>
</tbody></table>
</div>
<h2 id="3">STEP2. テーブルを用意する</h2>
<p>テーブルを2つ用意します。</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">テーブル名</th><th style="text-align: left">シート名</th><th style="text-align: left">役割</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>tblTasks</code></td><td style="text-align: left">タスク</td><td style="text-align: left">タスクの一覧と実績の記入</td></tr>
<tr><td style="text-align: left"><code>tblLogs</code></td><td style="text-align: left">ログ</td><td style="text-align: left">実績の記録</td></tr>
</tbody></table>
</div>
<p>タスクテーブル (<code>tblTasks</code>) の列 :</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">列名</th><th style="text-align: left">役割</th></tr></thead><tbody>
<tr><td style="text-align: left">タスクID</td><td style="text-align: left">タスクのID。自動採番。</td></tr>
<tr><td style="text-align: left">大分類</td><td style="text-align: left">タスクの分類 (大)。</td></tr>
<tr><td style="text-align: left">小分類</td><td style="text-align: left">タスクの分類 (小)。</td></tr>
<tr><td style="text-align: left">タスク名</td><td style="text-align: left">タスクの名称。</td></tr>
<tr><td style="text-align: left">起票日</td><td style="text-align: left">タスクを追加した日。</td></tr>
<tr><td style="text-align: left">期限</td><td style="text-align: left">タスクの期限。</td></tr>
<tr><td style="text-align: left">推定分</td><td style="text-align: left">推定所要時間</td></tr>
<tr><td style="text-align: left">実績分</td><td style="text-align: left">実績所要時間</td></tr>
<tr><td style="text-align: left">開始時刻</td><td style="text-align: left">(ログ記録用) 開始時間</td></tr>
<tr><td style="text-align: left">終了時刻</td><td style="text-align: left">(ログ記録用) 終了時間</td></tr>
<tr><td style="text-align: left">記</td><td style="text-align: left">(ログ記録用) ログ転記トリガ</td></tr>
<tr><td style="text-align: left">コメント</td><td style="text-align: left">タスクの詳細など。</td></tr>
</tbody></table>
</div>
<p>ログテーブル (<code>tblLogs</code>) の列 :</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">列名</th><th style="text-align: left">役割</th></tr></thead><tbody>
<tr><td style="text-align: left">タスクID</td><td style="text-align: left">タスクのID。</td></tr>
<tr><td style="text-align: left">日付</td><td style="text-align: left">タスクの分類 (大)。</td></tr>
<tr><td style="text-align: left">開始時刻</td><td style="text-align: left">タスクの分類 (小)。</td></tr>
<tr><td style="text-align: left">終了時刻</td><td style="text-align: left">タスクの分類 (小)。</td></tr>
<tr><td style="text-align: left">経過分</td><td style="text-align: left">このチャンクでの経過分数。</td></tr>
</tbody></table>
</div>
<h2 id="4">STEP3. タスクIDの自動採番</h2>
<p>タスクテーブルのタスク名が入力された際に、IDを自動採番する。</p>
<pre><code class="language-vba">Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo ExitHandler
    Application.EnableEvents = False

    If Not Intersect(Target, wsTasks.ListObjects("tblTasks").ListColumns("タスク名").DataBodyRange) Is Nothing Then
        AssignTaskId Target
    End If

ExitHandler:
    Application.EnableEvents = True
End Sub

Private Sub AssignTaskId(ByVal Target As Range)
    Dim tbl As ListObject
    Set tbl = wsTasks.ListObjects("tblTasks")

    Dim cell As Range
    For Each cell In Target
        If cell.Column = tbl.ListColumns("タスク名").Range.Column Then
            Dim rowIndex As Long
            rowIndex = cell.Row - tbl.HeaderRowRange.Row

            Dim idCell As Range
            Set idCell = tbl.ListColumns("ID").DataBodyRange.Cells(rowIndex, 1)

            If IsEmpty(idCell.Value) Then
                idCell.Value = GetNextTaskId()
            End If
        End If
    Next
End Sub

Private Function GetNextTaskId(tbl As ListObject) As Long
    Dim maxID As Long: maxID = 0
    Dim c As Range

    For Each c In tbl.ListColumns("ID").DataBodyRange
        If IsNumeric(c.Value) Then
            If c.Value &gt; maxID Then maxID = c.Value
        End If
    Next

    GetNextTaskID = maxID + 1
End Function
</code></pre>

      </div>
    </main>
    <footer>&copy; Sinotcaの雑記帳. All rights reserved.</footer>
  </body>
</html>
